server {
    listen 80;

    # 1. Definir la IP del Resolver de DNS. 
    # El DNS interno de Render/Docker suele ser 127.0.0.11 o 10.x.x.x. 
    # Usaremos el DNS de Google (8.8.8.8) temporalmente o el que Render usa internamente.
    # El más seguro para contenedores es 127.0.0.11 o 169.254.169.254 (Metadata Service).
    # Vamos a usar el DNS de Google por ser genérico.
    resolver 8.8.8.8; 

    # 2. Definir una variable para el nombre de host, que Nginx resolverá en runtime.
    set $api_host "crud-proyecto-tb1s.onrender.com";

    location /api/ {
        # Usamos la variable y el puerto 3000. 
        # Nginx resolverá $api_host a una IP *después* de iniciar.
        proxy_pass http://$api_host:3000/api/; 

        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}